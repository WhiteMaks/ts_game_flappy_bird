(()=>{"use strict";var t={9719:(t,e,r)=>{r.r(e),r.d(e,{default:()=>s});const s=r.p+"70bc56cc1144d8c4e7440f2e63d61bbf.png"},6584:(t,e,r)=>{r.r(e),r.d(e,{default:()=>s});const s=r.p+"82b09639403d51e592e9a874cccf959b.png"},1969:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(6668);class i extends s.default{constructor(t,e){super(t,e)}}e.default=i},4105:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(1114),i=r(3951),a=r(3325),n=r(7201),o=r(6584),h=r(8277),u=r(2674);class l extends s.default{constructor(t){super("Game layer"),this.graphicsElement=t}attach(){const t=this.graphicsElement.getGraphicsContext(),e=new Image;e.src=o.default,this.obstacleTexture=n.default.create2DTexture(t,e,4),this.obstacleTexture.bind(0),this.level=new h.default(t),this.cameraController=new i.default(this.graphicsElement,this.level.getPlayer())}detach(){}keyboardInput(t){this.cameraController.keyboardInput(t),t.getCode()===u.default.SPACE.valueOf()&&this.level.start()}mouseInput(t){this.cameraController.mouseInput(t)}update(t){this.cameraController.update(t),this.level.isPause()||(this.level.isGameOver()&&(this.level.restart(),this.level.update(t)),this.level.update(t))}render(){a.default.renderer.begin(this.cameraController.getCamera()),this.level.render(),a.default.renderer.end()}clean(){var t;null===(t=this.obstacleTexture)||void 0===t||t.clean(),this.level.clean()}}e.default=l},3325:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(1893),i=r(9921),a=r(9663),n=r(4353),o=r(3665),h=r(9878),u=r(6682),l=r(2152),d=r(2943),c=r(9693),f=r(4105),x=r(2420),g=r(4359);class y{constructor(){i.default.setAPI(o.default.WEB_GL),this.mouse=new a.default(16),this.keyboard=new n.default(16),u.default.instance=new h.default(this.mouse,this.keyboard),this.layerStack=new l.default,this.spaceColor=new c.default(.05,.05,.05,1)}init(t){const e=t.getGraphicsContext(),r=x.default.createProgram(e,"First shader program",g.textureVertexShaderCode,g.textureFragmentShaderCode);y.shaderProgramLibrary.add(r),y.renderer=d.default.create2D(e),y.renderer.init(e,r);const s=new f.default(t);this.layerStack.push(s);const i=t.getCanvasElement();this.addMouseListener(i),this.addKeyboardListener(i)}input(){this.mouseInput(),this.keyboardInput()}update(t){const e=this.layerStack.getLayers();for(let r of e)r.update(t);this.mouse.updateDirection()}render(){y.renderer.setClearColor(this.spaceColor),y.renderer.clear();const t=this.layerStack.getLayers();for(let e of t)e.render()}clean(){this.mouse.flush(),this.keyboard.flush();const t=this.layerStack.getLayers();for(let e of t)e.clean();y.shaderProgramLibrary.clean(),y.renderer.clean()}addMouseListener(t){t.addEventListener("mousedown",(t=>{0!==t.button?2!==t.button||this.mouse.onRightKeyPressed(t.offsetX,t.offsetY):this.mouse.onLeftKeyPressed(t.offsetX,t.offsetY)})),t.addEventListener("mouseup",(t=>{0!==t.button?2!==t.button||this.mouse.onRightKeyReleased(t.offsetX,t.offsetY):this.mouse.onLeftKeyReleased(t.offsetX,t.offsetY)})),t.addEventListener("mousemove",(t=>this.mouse.onMouseMove(t.offsetX,t.offsetY))),t.addEventListener("mouseenter",(()=>this.mouse.onMouseEnter())),t.addEventListener("mouseleave",(()=>this.mouse.onMouseLeave()))}addKeyboardListener(t){document.addEventListener("keydown",(t=>this.keyboard.onKeyPressed(t.code)),!1),document.addEventListener("keyup",(t=>this.keyboard.onKeyReleased(t.code)),!1),document.addEventListener("keypress",(t=>this.keyboard.onChar(t.key)),!1)}mouseInput(){const t=this.mouse.read();if(t.isValid()){const e=this.layerStack.getLayers().reverse();for(let r of e)r.mouseInput(t)}}keyboardInput(){const t=this.keyboard.readKey();if(t.isValid()){const e=this.layerStack.getLayers().reverse();for(let r of e)r.keyboardInput(t)}}}y.shaderProgramLibrary=new s.default,e.default=y},8277:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(7581),i=r(758),a=r(9719),n=r(6584),o=r(1761),h=r(7201);e.default=class{constructor(t){this.obstacleOffset=1.1,this.maxObstaclesCount=4,this.gameOver=!1,this.pause=!0;const e=new Image;e.src=a.default,this.player=new s.default(t,new i.default(0,0,0),e),this.obstacles=[];const r=new Image;r.src=n.default,this.obstacleTexture=h.default.create2DTexture(t,r,4),this.obstacleTexture.bind(0);for(let t=0;t<this.maxObstaclesCount;t++)this.createObstacle(t*this.obstacleOffset+1.5)}update(t){this.player.update(t),this.collisionTest()&&(this.gameOver=!0),this.player.getPosition().getX()>this.obstacles[2].getPosition().getX()&&(this.createObstacle(this.obstacles[this.obstacles.length-1].getPosition().getX()+this.obstacleOffset),this.obstacles.shift(),this.obstacles.shift())}render(){for(const t of this.obstacles)t.render();this.player.render()}getPlayer(){return this.player}collisionTest(){const t=this.player.getPosition();if(Math.abs(t.getY())>1)return!0;const e=this.player.getCollision();for(const t of this.obstacles){const r=t.getCollision();if(this.checkSquareCollisions(e[0],e[1],e[2]-e[0],e[7]-e[1],r[0],r[1],r[2]-r[0],r[7]-r[1]))return!0}return!1}checkSquareCollisions(t,e,r,s,i,a,n,o){return t+r>=i&&t<=i+n&&e+s>=a&&e<=a+o}createObstacle(t){const e=.2*Math.random(),r=.5*Math.random()-.25,s=new o.default(new i.default(t,r-.6-e,0),new i.default(0,0,0),this.obstacleTexture);this.obstacles.push(s);const a=new o.default(new i.default(t,r+.6+e,0),new i.default(0,0,180),this.obstacleTexture);this.obstacles.push(a)}isGameOver(){return this.gameOver}isPause(){return this.pause}start(){this.pause=!1}restart(){this.player.reset(),this.obstacles=[];for(let t=0;t<this.maxObstaclesCount;t++)this.createObstacle(t*this.obstacleOffset+1.5);this.gameOver=!1,this.pause=!0}clean(){for(const t of this.obstacles)t.clean();this.player.clean()}}},1761:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(758),i=r(3325);e.default=class{constructor(t,e,r){this.position=t,this.rotation=e,this.scale=new s.default(.1,1,1),this.texture=r}render(){i.default.renderer.drawTrianglesWithTexture(this.position,this.rotation,this.scale,this.texture)}getPosition(){return this.position}getCollision(){return[-.5*this.scale.getX()+this.position.getX(),-.5*this.scale.getY()+this.position.getY(),.5*this.scale.getX()+this.position.getX(),-.5*this.scale.getY()+this.position.getY(),.5*this.scale.getX()+this.position.getX(),.5*this.scale.getY()+this.position.getY(),-.5*this.scale.getX()+this.position.getX(),.5*this.scale.getY()+this.position.getY()]}clean(){this.texture.clean()}}},3951:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(2750);class i extends s.default{constructor(t,e){super(t),this.player=e}updateImpl(t){const e=this.camera.getPosition(),r=this.player.getPosition();e.setX(r.getX())}keyboardInput(t){}mouseInput(t){}}e.default=i},7581:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(758),i=r(7201),a=r(3325),n=r(6682),o=r(2674);e.default=class{constructor(t,e,r){this.position=e,this.rotation=new s.default(0,0,0),this.scale=new s.default(.1,.1,1),this.velocity=new s.default(7e-4,0,0),this.jumpPower=5e-5,this.gravity=4e-5,this.texture=i.default.create2DTexture(t,r,4),this.texture.bind(0)}reset(){this.position.setX(0),this.position.setY(0),this.position.setZ(0),this.rotation.setZ(0),this.velocity.setY(0)}update(t){let e;e=n.default.isKeyboardKeyPressed(o.default.SPACE)?this.velocity.getY()+this.jumpPower:this.velocity.getY()-this.gravity,e=this.clamp(e,-.002,.002),this.velocity.setY(e),this.position.setX(this.position.getX()+this.velocity.getX()*t.getDeltaTime()),this.position.setY(this.position.getY()+this.velocity.getY()*t.getDeltaTime()),this.rotation.setZ(4e4*this.velocity.getY())}render(){a.default.renderer.drawTrianglesWithTexture(this.position,this.rotation,this.scale,this.texture)}getPosition(){return this.position}clean(){this.texture.clean()}getCollision(){return[-.5*this.scale.getX()+this.position.getX(),-.5*this.scale.getY()+this.position.getY(),.5*this.scale.getX()+this.position.getX(),-.5*this.scale.getY()+this.position.getY(),.5*this.scale.getX()+this.position.getX(),.5*this.scale.getY()+this.position.getY(),-.5*this.scale.getX()+this.position.getX(),.5*this.scale.getY()+this.position.getY()]}clamp(t,e,r){return t>r?r:t<e?e:t}}},4359:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.textureFragmentShaderCode=e.textureVertexShaderCode=void 0,e.textureVertexShaderCode="#version 300 es\n\nlayout (location = 0) in vec4 a_Position;\nlayout (location = 1) in vec4 a_Color;\nlayout (location = 2) in vec2 a_TextCoord;\nlayout (location = 3) in float a_TextIndex;\n\nout vec2 v_TextCoord;\nout float v_TextIndex;\nout vec4 v_Color;\n\nuniform mat4 u_ViewProjectionMatrix;\n\nvoid main() {\n    v_TextCoord = vec2(a_TextCoord.x, 1.0f - a_TextCoord.y);\n    v_TextIndex = a_TextIndex;\n    v_Color = a_Color;\n    gl_Position = u_ViewProjectionMatrix * a_Position;\n}",e.textureFragmentShaderCode="#version 300 es\n\nprecision lowp float; //модификатор точности для фрагментного шейдера\n\nin vec2 v_TextCoord;\nin float v_TextIndex;\nin vec4 v_Color;\n\nuniform sampler2D u_Textures[16];\n\nout vec4 fragColor; //выходная переменная итогового цвета\n\nvoid main() {\n    vec4 textColor = v_Color;\n\n    int index = int(v_TextIndex);\n    switch (index) {\n        case 0:\n            textColor = textColor * texture(u_Textures[0], v_TextCoord);\n            break;\n        case 1:\n            textColor = textColor * texture(u_Textures[1], v_TextCoord);\n            break;\n        case 2:\n            textColor = textColor * texture(u_Textures[2], v_TextCoord);\n            break;\n        case 3:\n            textColor = textColor * texture(u_Textures[3], v_TextCoord);\n            break;\n        case 4:\n            textColor = textColor * texture(u_Textures[4], v_TextCoord);\n            break;\n        case 5:\n            textColor = textColor * texture(u_Textures[5], v_TextCoord);\n            break;\n        case 6:\n            textColor = textColor * texture(u_Textures[6], v_TextCoord);\n            break;\n        case 7:\n            textColor = textColor * texture(u_Textures[7], v_TextCoord);\n            break;\n        case 8:\n            textColor = textColor * texture(u_Textures[8], v_TextCoord);\n            break;\n        case 9:\n            textColor = textColor * texture(u_Textures[9], v_TextCoord);\n            break;\n        case 10:\n            textColor = textColor * texture(u_Textures[10], v_TextCoord);\n            break;\n        case 11:\n            textColor = textColor * texture(u_Textures[11], v_TextCoord);\n            break;\n        case 12:\n            textColor = textColor * texture(u_Textures[12], v_TextCoord);\n            break;\n        case 13:\n            textColor = textColor * texture(u_Textures[13], v_TextCoord);\n            break;\n        case 14:\n            textColor = textColor * texture(u_Textures[14], v_TextCoord);\n            break;\n        case 15:\n            textColor = textColor * texture(u_Textures[15], v_TextCoord);\n            break;\n    };\n    fragColor = textColor;\n}"},9878:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(6682);class i extends s.default{constructor(t,e){super(),this.mouse=t,this.keyboard=e}isKeyboardKeyPressedImpl(t){return this.keyboard.keyIsPressed(t)}isLeftMouseKeyPressedImpl(){return this.mouse.isLeftKeyPressed()}isRightMouseKeyPressedImpl(){return this.mouse.isRightKeyPressed()}}e.default=i},6682:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){}static isKeyboardKeyPressed(t){return this.instance.isKeyboardKeyPressedImpl(t)}static isLeftMouseKeyPressed(){return this.instance.isLeftMouseKeyPressedImpl()}static isRightMouseKeyPressed(){return this.instance.isRightMouseKeyPressedImpl()}}},2674:(t,e)=>{var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.A="KeyA",t.B="KeyB",t.C="KeyC",t.D="KeyD",t.E="KeyE",t.F="KeyF",t.G="KeyG",t.H="KeyH",t.I="KeyI",t.J="KeyJ",t.K="KeyK",t.L="KeyL",t.M="KeyM",t.N="KeyN",t.O="KeyO",t.P="KeyP",t.Q="KeyQ",t.R="KeyR",t.S="KeyS",t.T="KeyT",t.U="KeyU",t.V="KeyV",t.W="KeyW",t.X="KeyX",t.Y="KeyY",t.Z="KeyZ",t.LEFT_SHIFT="ShiftLeft",t.LEFT_CTR="ControlLeft",t.SPACE="Space"}(r||(r={})),e.default=r},4353:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(8590),i=r(9476),a=r(6686);e.default=class{constructor(t){this.bufferSize=16,this.bufferSize=t,this.keyBuffer=new s.default,this.charBuffer=new s.default,this.keyStates=new Map}keyIsPressed(t){return this.keyStates.get(t)||(this.keyStates.set(t,!1),!1)}readKey(){return this.keyBuffer.size()>0?this.keyBuffer.poll():new a.default(i.default.INVALID,"")}keyIsEmpty(){return 0===this.keyBuffer.size()}readChar(){return this.charBuffer.size()>0?this.charBuffer.poll():""}charIsEmpty(){return 0===this.charBuffer.size()}flushKey(){this.keyBuffer.flush()}flushChar(){this.charBuffer.flush()}flush(){this.flushKey(),this.flushChar()}onKeyPressed(t){this.keyStates.set(t,!0),this.keyBuffer.push(new a.default(i.default.PRESS,t)),this.trimBuffer(this.keyBuffer)}onKeyReleased(t){this.keyStates.set(t,!1),this.keyBuffer.push(new a.default(i.default.RELEASE,t)),this.trimBuffer(this.keyBuffer)}onChar(t){this.charBuffer.push(t),this.trimBuffer(this.charBuffer)}trimBuffer(t){for(;t.size()>this.bufferSize;)t.poll()}}},6686:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9476);e.default=class{constructor(t,e){this.type=t,this.code=e}isPress(){return this.type===s.default.PRESS}isRelease(){return this.type===s.default.RELEASE}isValid(){return this.type!==s.default.INVALID}getCode(){return this.code}}},9476:(t,e)=>{var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.PRESS=0]="PRESS",t[t.RELEASE=1]="RELEASE",t[t.INVALID=2]="INVALID"}(r||(r={})),e.default=r},9663:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(8590),i=r(2250),a=r(8477);e.default=class{constructor(t){this.bufferSize=t,this.buffer=new s.default,this.directionX=0,this.directionY=0,this.positionX=0,this.positionY=0,this.previousPositionX=0,this.previousPositionY=0,this.leftKeyIsPressed=!1,this.rightKeyIsPressed=!1,this.inFocus=!1}getPositionX(){return this.positionX}getPositionY(){return this.positionY}isInFocus(){return this.inFocus}isLeftKeyPressed(){return this.leftKeyIsPressed}isRightKeyPressed(){return this.rightKeyIsPressed}read(){return this.buffer.size()>0?this.buffer.poll():this.generateEvent(i.default.INVALID)}flush(){this.buffer.flush()}onMouseMove(t,e){this.positionX=t,this.positionY=e,this.buffer.push(this.generateEvent(i.default.MOVE)),this.trimBuffer()}onMouseLeave(){this.inFocus=!1,this.buffer.push(this.generateEvent(i.default.LEAVE)),this.trimBuffer()}onMouseEnter(){this.inFocus=!0,this.buffer.push(this.generateEvent(i.default.ENTER)),this.trimBuffer()}onLeftKeyPressed(t,e){this.leftKeyIsPressed=!0,this.buffer.push(this.generateEvent(i.default.L_PRESS)),this.trimBuffer()}onLeftKeyReleased(t,e){this.leftKeyIsPressed=!1,this.buffer.push(this.generateEvent(i.default.L_RELEASE)),this.trimBuffer()}onRightKeyPressed(t,e){this.rightKeyIsPressed=!0,this.buffer.push(this.generateEvent(i.default.R_PRESS)),this.trimBuffer()}onRightKeyReleased(t,e){this.rightKeyIsPressed=!1,this.buffer.push(this.generateEvent(i.default.R_RELEASE)),this.trimBuffer()}onWheelUp(t,e){this.buffer.push(this.generateEvent(i.default.WHEEL_UP)),this.trimBuffer()}onWheelDown(t,e){this.buffer.push(this.generateEvent(i.default.WHEEL_DOWN)),this.trimBuffer()}updateDirection(){this.directionX=0,this.directionY=0,this.previousPositionX>0&&this.previousPositionY>0&&(this.directionX=this.positionY-this.previousPositionY,this.directionY=this.positionX-this.previousPositionX),this.previousPositionX=this.positionX,this.previousPositionY=this.positionY}getDirectionX(){return this.directionX}getDirectionY(){return this.directionY}trimBuffer(){for(;this.buffer.size()>this.bufferSize;)this.buffer.poll()}generateEvent(t){return new a.default(t,this.leftKeyIsPressed,this.rightKeyIsPressed,this.positionX,this.positionY)}}},8477:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(2250);e.default=class{constructor(t,e,r,s,i){this.type=t,this.leftKeyIsPressed=e,this.rightKeyIsPressed=r,this.positionX=s,this.positionY=i}isValid(){return this.type!==s.default.INVALID}getPositionX(){return this.positionX}getPositionY(){return this.positionY}getType(){return this.type}isLeftKeyIsPressed(){return this.leftKeyIsPressed}isRightKeyIsPressed(){return this.rightKeyIsPressed}}},2250:(t,e)=>{var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.L_PRESS=0]="L_PRESS",t[t.L_RELEASE=1]="L_RELEASE",t[t.R_PRESS=2]="R_PRESS",t[t.R_RELEASE=3]="R_RELEASE",t[t.WHEEL_UP=4]="WHEEL_UP",t[t.WHEEL_DOWN=5]="WHEEL_DOWN",t[t.MOVE=6]="MOVE",t[t.ENTER=7]="ENTER",t[t.LEAVE=8]="LEAVE",t[t.INVALID=9]="INVALID"}(r||(r={})),e.default=r},8590:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.array=[]}peek(){return this.array[0]}poll(){let t=this.array.shift();if(!t)throw new Error("Нет элементов в очереди");return t}push(t){this.array.push(t)}size(){return this.array.length}flush(){for(;0!==this.size();)this.poll()}}},1697:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(6866);class i extends s.default{constructor(t,e){super(t,e)}}e.default=i},5657:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(8581);class i extends s.default{constructor(t,e){super(t,new Float32Array(e),e.length)}}e.default=i},4382:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,r){this.gl=t,this.buffer=t.createBuffer(),this.count=r,this.bind(),t.elementArrayBufferStaticData(e)}bind(){this.gl.bindElementArrayBuffer(this.buffer)}unbind(){this.gl.bindElementArrayBuffer(this.buffer)}getCount(){return this.count}clean(){this.gl.deleteBuffer(this.buffer)}setLayout(t){throw new Error("setLayout: not implemented method")}getLayout(){throw new Error("getLayout: not implemented method")}setFloat32Data(t){}}},937:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(4382);class i extends s.default{constructor(t,e){super(t,new Uint16Array(e),e.length)}}e.default=i},6566:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9380);e.default=class{constructor(t){this.gl=t,this.vertexBuffers=[],this.indexBuffer=null,this.buffer=t.createVertexArray(),this.bind()}getCount(){return 0}addVertexBuffer(t){this.bind(),t.bind();const e=t.getLayout(),r=t.getLayout().getElements();for(let t=0;t<r.length;t++){const i=r[t];switch(this.gl.enableVertexAttribArray(t),i.type){case s.default.FLOAT_4:case s.default.FLOAT_3:case s.default.FLOAT_2:case s.default.FLOAT_1:this.gl.vertexAttribPointerFloat(t,(0,s.getComponentCountFromShaderDataType)(i.type),i.normalized,e.getStride(),i.offset);break;case s.default.INT_4:case s.default.INT_3:case s.default.INT_2:case s.default.INT_1:this.gl.vertexAttribPointerUint(t,(0,s.getComponentCountFromShaderDataType)(i.type),i.normalized,e.getStride(),i.offset);break;default:throw new Error("ShaderDataType [ "+i.type+" ] not supported")}}this.vertexBuffers.push(t)}setIndexBuffer(t){this.bind(),t.bind(),this.indexBuffer=t}bind(){this.gl.bindVertexArray(this.buffer)}unbind(){this.gl.unbindVertexArray()}clean(){var t;this.gl.deleteVertexArray(this.buffer);for(const t of this.vertexBuffers)t.clean();null===(t=this.indexBuffer)||void 0===t||t.clean()}setLayout(t){throw new Error("setLayout: not implemented method")}getLayout(){throw new Error("getLayout: not implemented method")}getVertexBuffers(){return this.vertexBuffers}getIndexBuffer(){return this.indexBuffer}setFloat32Data(t){}}},6866:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.gl=t,this.buffer=t.createBuffer(),this.layout=null,this.bind(),t.arrayBufferDynamicData(e)}bind(){this.gl.bindArrayBuffer(this.buffer)}unbind(){this.gl.unbindArrayBuffer()}getCount(){throw new Error("getCount not supported in Vertex Buffer")}clean(){this.gl.deleteBuffer(this.buffer)}setLayout(t){this.layout=t}getLayout(){return this.layout}setFloat32Data(t){this.bind(),this.gl.arrayBufferSubData(new Float32Array(t))}}},8581:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,r){this.gl=t,this.buffer=t.createBuffer(),this.count=r,this.layout=null,this.bind(),t.arrayBufferStaticData(e)}bind(){this.gl.bindArrayBuffer(this.buffer)}unbind(){this.gl.unbindArrayBuffer()}getCount(){return this.count}clean(){this.gl.deleteBuffer(this.buffer)}setLayout(t){this.layout=t}getLayout(){return this.layout}setFloat32Data(t){}}},1923:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(8013);class i extends s.default{constructor(t){super(),this.gl=t}clear(){this.gl.clearColorBuffer(),this.gl.clearDepthBuffer()}setClearColor(t){this.gl.clearColor(t.getX(),t.getY(),t.getZ(),t.getW())}drawTrianglesImpl(t,e=0){const r=0===e?t.getCount():e;this.gl.drawTriangleElementsUshort(r,0)}initImpl(){this.gl.enableDepthTest(),this.gl.enableBlend(),this.gl.blendFuncSrcAlphaOneMinusSrcAlpha()}}e.default=i},9447:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9436);e.default=class{constructor(t){this.canvasElement=t;const e=this.canvasElement.getContext("webgl2");if(!e)throw new Error("Невозможно проинициализировать WebGL. Данный браузер не поддерживает данный контекст [ webgl2 ]");this.gl=new s.default(e)}init(){}setViewport(t,e,r,s){this.gl.setViewport(t,e,r,s)}printDebugInfo(){console.log("Vendor: "+this.gl.getVendor()),console.log("Renderer: "+this.gl.getRenderer())}getGL(){return this.gl}}},8525:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(3466);e.default=class{constructor(t,e,r,i=!1){if(this.gl=t,this.id=(0,s.uuid)(),this.texture=this.gl.createTexture(),i)return this.prepareTexture(),void this.gl.texImage2DRGBAUbyteWithPixels(0,e,new Uint8Array([255,255,255,255]));e.onload=()=>{this.prepareTexture(),4===r&&this.gl.texImage2DRGBAUbyte(0,e),3===r&&this.gl.texImage2DRGBUbyte(0,e)}}bind(t){this.gl.activeTexture(t),this.gl.bindTexture2D(this.texture)}unbind(){this.gl.unbindTexture2D()}clean(){this.gl.deleteTexture(this.texture)}equal(t){return this.id===t.id}prepareTexture(){this.gl.bindTexture2D(this.texture),this.gl.tex2DParameteriMinFilterLinear(),this.gl.tex2DParameteriMagFilterNearest(),this.gl.tex2DParameteriWrapSClampToEdge(),this.gl.tex2DParameteriWrapTClampToEdge()}}},5023:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.gl=t,this.vs=this.gl.createFragmentShader(),this.gl.setShaderSource(this.vs,e)}getShader(){return this.vs}clean(){this.gl.deleteShader(this.vs)}}},1253:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,r,s){this.locationsCache=new Map,this.gl=t,this.name=e,this.vertexShader=r,this.fragmentShader=s,this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader.getShader()),this.gl.attachShader(this.program,this.fragmentShader.getShader()),this.gl.linkProgram(this.program),this.vertexShader.clean(),this.fragmentShader.clean()}getName(){return this.name}bind(){this.gl.useProgram(this.program)}unbind(){this.gl.removeProgram()}setVector3f(t,e){this.gl.uniform3f(this.getUniformLocation(t),e)}setVector4f(t,e){this.gl.uniform4f(this.getUniformLocation(t),e)}setValue1i(t,e){this.gl.uniform1i(this.getUniformLocation(t),e)}setValueArrayI(t,e){this.gl.uniform1iv(this.getUniformLocation(t),e)}setMatrix4f(t,e){this.gl.uniformMatrix4fv(this.getUniformLocation(t),!1,new Float32Array(e.getArray()))}getUniformLocation(t){let e=this.locationsCache.get(t);return e||(e=this.gl.getUniformLocation(this.program,t),this.locationsCache.set(t,e)),e}clean(){this.vertexShader.clean(),this.fragmentShader.clean(),this.gl.deleteProgram(this.program)}}},4264:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.gl=t,this.vs=this.gl.createVertexShader(),this.gl.setShaderSource(this.vs,e)}getShader(){return this.vs}clean(){this.gl.deleteShader(this.vs)}}},9436:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.context=t,this.clearColor(0,0,0,1);const e=this.context.getExtension("WEBGL_debug_renderer_info");e?(this.vendor=this.context.getParameter(e.UNMASKED_VENDOR_WEBGL),this.renderer=this.context.getParameter(e.UNMASKED_RENDERER_WEBGL)):(this.vendor="HIDDEN",this.renderer="HIDDEN")}enableDepthTest(){this.context.enable(this.context.DEPTH_TEST)}enableBlend(){this.context.enable(this.context.BLEND)}disableBlend(){this.context.disable(this.context.BLEND)}blendFuncSrcAlphaOneMinusSrcAlpha(){this.context.blendFunc(this.context.SRC_ALPHA,this.context.ONE_MINUS_SRC_ALPHA)}clearColor(t,e,r,s){this.context.clearColor(t,e,r,s)}clearColorBuffer(){this.context.clear(this.context.COLOR_BUFFER_BIT)}clearDepthBuffer(){this.context.clear(this.context.DEPTH_BUFFER_BIT)}setViewport(t,e,r,s){this.context.viewport(0,0,r,s)}createVertexShader(){let t=this.context.createShader(this.context.VERTEX_SHADER);if(!t)throw new Error("Ошибка создания вершинного шейдера");return t}createFragmentShader(){let t=this.context.createShader(this.context.FRAGMENT_SHADER);if(!t)throw new Error("Ошибка создания фрагментного шейдера");return t}deleteShader(t){this.context.deleteShader(t)}setShaderSource(t,e){if(this.context.shaderSource(t,e),this.context.compileShader(t),!this.context.getShaderParameter(t,this.context.COMPILE_STATUS)){const e=this.context.getShaderInfoLog(t);throw this.deleteShader(t),new Error(null!=e?e:"Ошибка компиляции шейдера")}}createProgram(){let t=this.context.createProgram();if(!t)throw new Error("Ошибка создания программы");return t}deleteProgram(t){this.context.deleteProgram(t)}attachShader(t,e){this.context.attachShader(t,e)}linkProgram(t){if(this.context.linkProgram(t),!this.context.getProgramParameter(t,this.context.LINK_STATUS)){const e=this.context.getProgramInfoLog(t);throw new Error(null!=e?e:"Ошибка связывания программы с шейдерами")}}useProgram(t){this.context.useProgram(t)}removeProgram(){this.context.useProgram(null)}createVertexArray(){let t=this.context.createVertexArray();if(!t)throw new Error("Ошибка создания VAO");return t}deleteVertexArray(t){this.context.deleteVertexArray(t)}bindVertexArray(t){this.context.bindVertexArray(t)}unbindVertexArray(){this.context.bindVertexArray(null)}createTexture(){const t=this.context.createTexture();if(!t)throw new Error("Ошибка создания текстуры");return t}deleteTexture(t){this.context.deleteTexture(t)}unbindTexture2D(){this.context.bindTexture(this.context.TEXTURE_2D,null)}bindTexture2D(t){this.context.bindTexture(this.context.TEXTURE_2D,t)}tex2DParameteriMinFilterLinear(){this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_MIN_FILTER,this.context.LINEAR)}tex2DParameteriMagFilterLinear(){this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_MAG_FILTER,this.context.LINEAR)}tex2DParameteriMagFilterNearest(){this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_MAG_FILTER,this.context.NEAREST)}tex2DParameteriWrapSClampToEdge(){this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_WRAP_S,this.context.CLAMP_TO_EDGE)}tex2DParameteriWrapTClampToEdge(){this.context.texParameteri(this.context.TEXTURE_2D,this.context.TEXTURE_WRAP_T,this.context.CLAMP_TO_EDGE)}texImage2DRGBAUbyteWithPixels(t,e,r){this.context.texImage2D(this.context.TEXTURE_2D,t,this.context.RGBA8,e.width,e.height,0,this.context.RGBA,this.context.UNSIGNED_BYTE,r)}texImage2DRGBAUbyte(t,e){this.context.texImage2D(this.context.TEXTURE_2D,t,this.context.RGBA8,e.width,e.height,0,this.context.RGBA,this.context.UNSIGNED_BYTE,e)}texImage2DRGBUbyte(t,e){this.context.texImage2D(this.context.TEXTURE_2D,t,this.context.RGB8,e.width,e.height,0,this.context.RGB,this.context.UNSIGNED_BYTE,e)}generateMipmap2D(){this.context.generateMipmap(this.context.TEXTURE_2D)}createBuffer(){const t=this.context.createBuffer();if(!t)throw new Error("Ошибка создания буфера");return t}deleteBuffer(t){this.context.deleteBuffer(t)}bindArrayBuffer(t){this.context.bindBuffer(this.context.ARRAY_BUFFER,t)}unbindArrayBuffer(){this.context.bindBuffer(this.context.ARRAY_BUFFER,null)}bindElementArrayBuffer(t){this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER,t)}arrayBufferDynamicData(t){this.context.bufferData(this.context.ARRAY_BUFFER,t,this.context.DYNAMIC_DRAW)}getArrayBufferSize(){return this.context.getBufferParameter(this.context.ARRAY_BUFFER,this.context.BUFFER_SIZE)}arrayBufferSubData(t){this.context.bufferSubData(this.context.ARRAY_BUFFER,0,t)}arrayBufferStaticData(t){this.context.bufferData(this.context.ARRAY_BUFFER,t,this.context.STATIC_DRAW)}elementArrayBufferStaticData(t){this.context.bufferData(this.context.ELEMENT_ARRAY_BUFFER,t,this.context.STATIC_DRAW)}enableVertexAttribArray(t){this.context.enableVertexAttribArray(t)}disableVertexAttribArray(t){this.context.disableVertexAttribArray(t)}vertexAttribDivisor(t,e){this.context.vertexAttribDivisor(t,e)}vertexAttribPointerFloat(t,e,r,s,i){this.context.vertexAttribPointer(t,e,this.context.FLOAT,r,s,i)}vertexAttribPointerUint(t,e,r,s,i){this.context.vertexAttribPointer(t,e,this.context.UNSIGNED_INT,r,s,i)}drawTriangleArrays(t,e){this.context.drawArrays(this.context.TRIANGLES,t,e)}drawTriangleElementsUshort(t,e){this.context.drawElements(this.context.TRIANGLES,t,this.context.UNSIGNED_SHORT,e)}drawTriangleElementsUint(t,e){this.context.drawElements(this.context.TRIANGLES,t,this.context.UNSIGNED_INT,e)}drawLineElementsUshort(t,e){this.context.drawElements(this.context.LINES,t,this.context.UNSIGNED_SHORT,e)}getUniformLocation(t,e){const r=this.context.getUniformLocation(t,e);if(!r)throw new Error("Ошибка получения униформы с именем [ "+e+" ]");return r}uniformMatrix4fv(t,e,r){this.context.uniformMatrix4fv(t,e,r)}uniform3f(t,e){this.context.uniform3f(t,e.getX(),e.getY(),e.getZ())}uniform4f(t,e){this.context.uniform4f(t,e.getX(),e.getY(),e.getZ(),e.getW())}uniform1iv(t,e){this.context.uniform1iv(t,new Int32Array(e))}uniform1i(t,e){this.context.uniform1i(t,e)}uniformF(t,e){this.context.uniform1f(t,e)}activeTexture(t){this.context.activeTexture(this.context.TEXTURE0+t)}getVendor(){return this.vendor}getRenderer(){return this.renderer}}},846:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NewBufferElement=void 0,e.NewBufferElement=function(t,e,r=!1){return{type:t,name:e,size:t.valueOf(),offset:0,normalized:r}}},4775:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.elements=t,this.stride=0,this.calculateStride()}getElements(){return this.elements}getStride(){return this.stride}sizeof(){let t=0;for(const e of this.elements)t+=e.size;return t}calculateStride(){let t=0;for(const e of this.elements)e.offset=t,t+=e.size,this.stride+=e.size}}},2750:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(2590),i=r(2107);class a extends s.default{constructor(t,e=1){super(new i.default(t,e))}}e.default=a},2590:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.camera=t}update(t){this.camera.update(),this.updateImpl(t)}getCamera(){return this.camera}}},2107:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(8144),i=r(1507);class a extends i.default{constructor(t,e=1){super(s.default.getOrthogonalProjectionMatrix(-1*t.getWidth()/t.getHeight()*e,t.getWidth()/t.getHeight()*e,-1*e,e,-1,1)),this.graphicsElement=t,this.zoomLevel=e}update(){this.recalculateViewMatrix(),this.recalculateProjectionMatrix(),this.recalculateViewProjectionMatrix()}setZoomLevel(t){this.zoomLevel=t}getZoomLevel(){return this.zoomLevel}recalculateViewMatrix(){this.viewMatrix=s.default.getViewMatrix(this.position,this.rotation)}recalculateProjectionMatrix(){const t=this.graphicsElement.getWidth()/this.graphicsElement.getHeight();this.projectionMatrix=s.default.getOrthogonalProjectionMatrix(-1*t*this.zoomLevel,t*this.zoomLevel,-1*this.zoomLevel,this.zoomLevel,-1,1)}recalculateViewProjectionMatrix(){this.viewProjectionMatrix=this.viewMatrix.multiplyMatrix(this.projectionMatrix)}}e.default=a},1507:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(758),i=r(8144);e.default=class{constructor(t){this.projectionMatrix=t,this.position=new s.default(0,0,0),this.rotation=new s.default(0,0,0),this.viewMatrix=i.default.getViewMatrix(this.position,this.rotation),this.viewProjectionMatrix=this.viewMatrix.multiplyMatrix(this.projectionMatrix)}getPosition(){return this.position}getProjectionMatrix(){return this.projectionMatrix}getRotation(){return this.rotation}getViewMatrix(){return this.viewMatrix}getViewProjectionMatrix(){return this.viewProjectionMatrix}setPosition(t){this.position=t}setRotation(t){this.rotation=t}}},2417:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9921),i=r(3665),a=r(6566),n=r(937),o=r(5657),h=r(1697);e.default=class{static createFloat32VertexDynamicBuffer(t,e){if(s.default.getAPI()===i.default.WEB_GL){const r=t.getGL();return new h.default(r,e)}}static createFloat32VertexStaticBuffer(t,e){if(s.default.getAPI()===i.default.WEB_GL){const r=t.getGL();return new o.default(r,e)}}static createUint16IndexStaticBuffer(t,e){if(s.default.getAPI()===i.default.WEB_GL){const r=t.getGL();return new n.default(r,e)}}static createVertexArrayBuffer(t){if(s.default.getAPI()===i.default.WEB_GL){const e=t.getGL();return new a.default(e)}}}},8632:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(3665),i=r(9447),a=r(9921);e.default=class{static createContext(t){if(a.default.getAPI()===s.default.WEB_GL)return new i.default(t)}}},2943:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9921),i=r(3665),a=r(1923);e.default=class{static create2D(t){if(s.default.getAPI()===i.default.WEB_GL){const e=t.getGL();return new a.default(e)}}}},7201:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9921),i=r(3665),a=r(8525);class n{static create2DFullWhiteTexture(t){const e=new Image(1,1);return n.create2DTexture(t,e,4,!0)}static create2DTexture(t,e,r,n=!1){if(s.default.getAPI()===i.default.WEB_GL){const s=t.getGL();return new a.default(s,e,r,n)}}}e.default=n},2420:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9921),i=r(3665),a=r(4264),n=r(5023),o=r(1253);e.default=class{static createProgram(t,e,r,h){if(s.default.getAPI()===i.default.WEB_GL){const s=t.getGL(),i=new a.default(s,r),u=new n.default(s,h);return new o.default(s,e,i,u)}}}},6668:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(5716),i=r(8191);e.default=class{constructor(t,e){this.logic=e,this.graphicElement=new s.default(t),this.time=new i.default,this.frame=0,this.shouldBeClosed=!1}start(){this.init(),this.startNewFrame()}stop(){this.shouldBeClosed=!0}init(){this.graphicElement.init(),this.logic.init(this.graphicElement)}startNewFrame(){if(this.graphicElement.notExist()||this.shouldBeClosed)return window.cancelAnimationFrame(this.frame),void this.clean();this.frame=window.requestAnimationFrame((t=>this.loop(t)))}loop(t){this.input(),this.update(t),this.render(),this.endFrame(),this.startNewFrame()}input(){this.logic.input()}update(t){this.time.update(t),this.graphicElement.update(),this.logic.update(this.time)}render(){this.graphicElement.render(),this.logic.render()}endFrame(){}clean(){this.logic.clean(),this.graphicElement.destroy()}}},5716:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(8632);e.default=class{constructor(t){this.parentElement=t,this.canvasElement=document.createElement("canvas"),this.canvasElement.style.display="block",this.canvasElement.style.width="100%",this.canvasElement.style.height="100%",this.canvasElement.oncontextmenu=function(){return!1},this.graphicsContext=s.default.createContext(this.canvasElement)}notExist(){return null==this.canvasElement.offsetParent}init(){this.embedToElement(),this.addListenerResizeWindow(),this.graphicsContext.init()}render(){}getGraphicsContext(){return this.graphicsContext}getWidth(){return this.canvasElement.width}getHeight(){return this.canvasElement.height}update(){}destroy(){this.canvasElement.remove()}getCanvasElement(){return this.canvasElement}embedToElement(){this.parentElement.append(this.canvasElement),this.resizeCanvasElement()}addListenerResizeWindow(){window.addEventListener("resize",(()=>this.resizeCanvasElement()))}updateViewport(){this.graphicsContext.setViewport(0,0,this.canvasElement.width,this.canvasElement.height)}resizeCanvasElement(){this.canvasElement.width=this.parentElement.offsetWidth,this.canvasElement.height=this.parentElement.offsetHeight,this.updateViewport()}}},1114:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t="layer"){this.name=t}getName(){return this.name}}},2152:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.layers=[],this.layerInsert=0}push(t){this.layers.splice(this.layerInsert,0,t),t.attach(),this.layerInsert++}pushOverlay(t){this.layers.push(t),t.attach()}clean(){for(;this.layers.length>0;)this.layers.pop()}getLayers(){return this.layers}}},7245:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9693);class i{constructor(t){this.arrayMatrix=t}static identity(){return new i([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}getArray(){return this.arrayMatrix}multiplyMatrix(t){const e=this.a11()*t.a11()+this.a12()*t.a21()+this.a13()*t.a31()+this.a14()*t.a41(),r=this.a11()*t.a12()+this.a12()*t.a22()+this.a13()*t.a32()+this.a14()*t.a42(),s=this.a11()*t.a13()+this.a12()*t.a23()+this.a13()*t.a33()+this.a14()*t.a43(),a=this.a11()*t.a14()+this.a12()*t.a24()+this.a13()*t.a34()+this.a14()*t.a44(),n=this.a21()*t.a11()+this.a22()*t.a21()+this.a23()*t.a31()+this.a24()*t.a41(),o=this.a21()*t.a12()+this.a22()*t.a22()+this.a23()*t.a32()+this.a24()*t.a42(),h=this.a21()*t.a13()+this.a22()*t.a23()+this.a23()*t.a33()+this.a24()*t.a43(),u=this.a21()*t.a14()+this.a22()*t.a24()+this.a23()*t.a34()+this.a24()*t.a44(),l=this.a31()*t.a11()+this.a32()*t.a21()+this.a33()*t.a31()+this.a34()*t.a41(),d=this.a31()*t.a12()+this.a32()*t.a22()+this.a33()*t.a32()+this.a34()*t.a42(),c=this.a31()*t.a13()+this.a32()*t.a23()+this.a33()*t.a33()+this.a34()*t.a43(),f=this.a31()*t.a14()+this.a32()*t.a24()+this.a33()*t.a34()+this.a34()*t.a44(),x=this.a41()*t.a11()+this.a42()*t.a21()+this.a43()*t.a31()+this.a44()*t.a41(),g=this.a41()*t.a12()+this.a42()*t.a22()+this.a43()*t.a32()+this.a44()*t.a42(),y=this.a41()*t.a13()+this.a42()*t.a23()+this.a43()*t.a33()+this.a44()*t.a43(),m=this.a41()*t.a14()+this.a42()*t.a24()+this.a43()*t.a34()+this.a44()*t.a44();return new i([e,r,s,a,n,o,h,u,l,d,c,f,x,g,y,m])}multiplyVector(t){const e=this.a11()*t.getX()+this.a12()*t.getY()+this.a13()*t.getZ()+this.a14()*t.getW(),r=this.a21()*t.getX()+this.a22()*t.getY()+this.a23()*t.getZ()+this.a24()*t.getW(),i=this.a31()*t.getX()+this.a32()*t.getY()+this.a33()*t.getZ()+this.a34()*t.getW(),a=this.a41()*t.getX()+this.a42()*t.getY()+this.a43()*t.getZ()+this.a44()*t.getW();return new s.default(e,r,i,a)}a11(){return this.arrayMatrix[0]}a12(){return this.arrayMatrix[1]}a13(){return this.arrayMatrix[2]}a14(){return this.arrayMatrix[3]}a21(){return this.arrayMatrix[4]}a22(){return this.arrayMatrix[5]}a23(){return this.arrayMatrix[6]}a24(){return this.arrayMatrix[7]}a31(){return this.arrayMatrix[8]}a32(){return this.arrayMatrix[9]}a33(){return this.arrayMatrix[10]}a34(){return this.arrayMatrix[11]}a41(){return this.arrayMatrix[12]}a42(){return this.arrayMatrix[13]}a43(){return this.arrayMatrix[14]}a44(){return this.arrayMatrix[15]}transpose(){return new i([this.a11(),this.a21(),this.a31(),this.a41(),this.a12(),this.a22(),this.a32(),this.a42(),this.a13(),this.a23(),this.a33(),this.a43(),this.a14(),this.a24(),this.a34(),this.a44()])}determinant(){const t=this.a33()*this.a44()-this.a43()*this.a34(),e=this.a32()*this.a44()-this.a42()*this.a34(),r=this.a32()*this.a43()-this.a42()*this.a33(),s=this.a31()*this.a44()-this.a41()*this.a34(),i=this.a31()*this.a43()-this.a41()*this.a33(),a=this.a31()*this.a42()-this.a41()*this.a32();return this.a11()*(this.a22()*t-this.a23()*e+this.a24()*r)-this.a12()*(this.a21()*t-this.a23()*s+this.a24()*i)+this.a13()*(this.a21()*e-this.a22()*s+this.a24()*a)-this.a14()*(this.a21()*r-this.a22()*i+this.a23()*a)}}e.default=i},758:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(t,e,r){this.x=t,this.y=e,this.z=r}setX(t){this.x=t}setY(t){this.y=t}setZ(t){this.z=t}getX(){return this.x}getY(){return this.y}getZ(){return this.z}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}getNormalization(){const t=this.getInversionLength();return new r(this.x*t,this.y*t,this.z*t)}getInversionLength(){return 1/this.getLength()}}e.default=r},9693:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class r{constructor(t,e,r,s){this.x=t,this.y=e,this.z=r,this.w=s}setX(t){this.x=t}setY(t){this.y=t}setZ(t){this.z=t}getX(){return this.x}getY(){return this.y}getZ(){return this.z}getW(){return this.w}setW(t){this.w=t}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}getNormalization(){const t=this.getInversionLength();return new r(this.x*t,this.y*t,this.z*t,this.w*t)}getInversionLength(){return 1/this.getLength()}}e.default=r},8144:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(758),i=r(7245);class a{static getWorldMatrix(t,e,r){const s=this.getTranslationMatrix(i.default.identity(),t),n=this.getRotationXMatrix(s,a.degreesToRadians(e.getX())),o=this.getRotationYMatrix(n,a.degreesToRadians(e.getY())),h=this.getRotationZMatrix(o,a.degreesToRadians(e.getZ()));return this.getScale(h,r)}static getVectorFromWorldMatrix(t,e){return t.transpose().multiplyVector(e)}static getPerspectiveProjectionMatrix(t,e,r,s){const a=1/Math.tan(e/2),n=1/(r-s);return new i.default([a/t,0,0,0,0,a,0,0,0,0,(s+r)*n,-1,0,0,2*s*r*n,0])}static getOrthogonalProjectionMatrix(t,e,r,s,a,n){const o=1/(t-e),h=1/(r-s),u=1/(n-a);return new i.default([-2*o,0,0,0,0,-2*h,0,0,0,0,-2*u,0,(t+e)*o,(s+r)*h,-1*(n+a)*u,1])}static getViewMatrix(t,e){const r=this.getRotationMatrix(i.default.identity(),a.degreesToRadians(e.getX()),new s.default(1,0,0)),n=this.getRotationMatrix(r,a.degreesToRadians(e.getY()),new s.default(0,1,0));return this.getTranslationMatrix(n,new s.default(-t.getX(),-t.getY(),-t.getZ()))}static degreesToRadians(t){return t*(Math.PI/180)}static getTranslationMatrix(t,e){return new i.default([t.a11(),t.a12(),t.a13(),t.a14(),t.a21(),t.a22(),t.a23(),t.a24(),t.a31(),t.a32(),t.a33(),t.a34(),t.a11()*e.getX()+t.a21()*e.getY()+t.a31()*e.getZ()+t.a41(),t.a12()*e.getX()+t.a22()*e.getY()+t.a32()*e.getZ()+t.a42(),t.a13()*e.getX()+t.a23()*e.getY()+t.a33()*e.getZ()+t.a43(),t.a14()*e.getX()+t.a24()*e.getY()+t.a34()*e.getZ()+t.a44()])}static getRotationXMatrix(t,e){const r=Math.sin(e),s=Math.cos(e);return new i.default([t.a11(),t.a12(),t.a13(),t.a14(),t.a21()*s+t.a31()*r,t.a22()*s+t.a32()*r,t.a23()*s+t.a33()*r,t.a24()*s+t.a34()*r,t.a31()*s-t.a21()*r,t.a32()*s-t.a22()*r,t.a33()*s-t.a23()*r,t.a34()*s-t.a24()*r,t.a41(),t.a42(),t.a43(),t.a44()])}static getRotationYMatrix(t,e){const r=Math.sin(e),s=Math.cos(e);return new i.default([t.a11()*s-t.a31()*r,t.a12()*s-t.a32()*r,t.a13()*s-t.a33()*r,t.a14()*s-t.a34()*r,t.a21(),t.a22(),t.a23(),t.a24(),t.a11()*r+t.a31()*s,t.a12()*r+t.a32()*s,t.a13()*r+t.a33()*s,t.a14()*r+t.a34()*s,t.a41(),t.a42(),t.a43(),t.a44()])}static getRotationZMatrix(t,e){const r=Math.sin(e),s=Math.cos(e);return new i.default([t.a11()*s+t.a21()*r,t.a12()*s+t.a22()*r,t.a13()*s+t.a23()*r,t.a14()*s+t.a24()*r,t.a21()*s-t.a11()*r,t.a22()*s-t.a12()*r,t.a23()*s-t.a13()*r,t.a24()*s-t.a14()*r,t.a31(),t.a32(),t.a33(),t.a34(),t.a41(),t.a42(),t.a43(),t.a44()])}static getScale(t,e){return new i.default([t.a11()*e.getX(),t.a12()*e.getX(),t.a13()*e.getX(),t.a14()*e.getX(),t.a21()*e.getY(),t.a22()*e.getY(),t.a23()*e.getY(),t.a24()*e.getY(),t.a31()*e.getZ(),t.a32()*e.getZ(),t.a33()*e.getZ(),t.a34()*e.getZ(),t.a41(),t.a42(),t.a43(),t.a44()])}static getRotationMatrix(t,e,r){const s=Math.sin(e),a=Math.cos(e),n=1-a,o=r.getNormalization(),h=o.getX()*o.getX()*n+a,u=o.getY()*o.getX()*n+o.getZ()*s,l=o.getZ()*o.getX()*n-o.getY()*s,d=o.getX()*o.getY()*n-o.getZ()*s,c=o.getY()*o.getY()*n+a,f=o.getZ()*o.getY()*n+o.getX()*s,x=o.getX()*o.getZ()*n+o.getY()*s,g=o.getY()*o.getZ()*n-o.getX()*s,y=o.getZ()*o.getZ()*n+a;return new i.default([t.a11()*h+t.a21()*u+t.a31()*l,t.a12()*h+t.a22()*u+t.a32()*l,t.a13()*h+t.a23()*u+t.a33()*l,t.a14()*h+t.a24()*u+t.a34()*l,t.a11()*d+t.a21()*c+t.a31()*f,t.a12()*d+t.a22()*c+t.a32()*f,t.a13()*d+t.a23()*c+t.a33()*f,t.a14()*d+t.a24()*c+t.a34()*f,t.a11()*x+t.a21()*g+t.a31()*y,t.a12()*x+t.a22()*g+t.a32()*y,t.a13()*x+t.a23()*g+t.a33()*y,t.a14()*x+t.a24()*g+t.a34()*y,t.a41(),t.a42(),t.a43(),t.a44()])}}e.default=a},9921:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(3665);class i{static getAPI(){return this.rendererAPI}static setAPI(t){i.rendererAPI=t}}i.rendererAPI=s.default.WEB_GL,e.default=i},8013:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=r(9693),i=r(7245),a=r(7201),n=r(4775),o=r(846),h=r(9380),u=r(2417),l=r(8144),d=r(1649);class c{constructor(){this.quadVertexBuffer=new Array(0),this.quadVertexBufferIndex=0,this.quadIndexCount=0,this.textureSlots=new Array(c.maxTextureSlots),this.textureSlotIndex=1,this.whiteColor=null,this.whiteTexture=null,this.vertexArray=null,this.vertexBuffer=null,this.shaderProgram=null,this.viewProjectionMatrix=new i.default([]),this.worldMatrix=new i.default([]),this.quadPositions=[new s.default(-.5,-.5,0,1),new s.default(.5,-.5,0,1),new s.default(.5,.5,0,1),new s.default(-.5,.5,0,1)],this.statistics=new d.default}init(t,e){this.shaderProgram=e,this.whiteColor=new s.default(1,1,1,1),this.whiteTexture=a.default.create2DFullWhiteTexture(t),this.initImpl();const r=new n.default([(0,o.NewBufferElement)(h.default.FLOAT_3,"a_Position"),(0,o.NewBufferElement)(h.default.FLOAT_4,"a_Color"),(0,o.NewBufferElement)(h.default.FLOAT_2,"a_TextureCoordinate"),(0,o.NewBufferElement)(h.default.FLOAT_1,"a_TextureIndex")]);this.vertexBuffer=u.default.createFloat32VertexDynamicBuffer(t,c.maxVertices*r.sizeof()),this.vertexBuffer.setLayout(r),this.quadVertexBuffer=new Array(c.maxVertices*r.sizeof());const i=new Array(c.maxIndices);let l=0;for(let t=0;t<i.length;t+=6)i[t]=l,i[t+1]=l+1,i[t+2]=l+2,i[t+3]=l+2,i[t+4]=l+3,i[t+5]=l,l+=4;const d=u.default.createUint16IndexStaticBuffer(t,i);this.vertexArray=u.default.createVertexArrayBuffer(t),this.vertexArray.addVertexBuffer(this.vertexBuffer),this.vertexArray.setIndexBuffer(d),this.vertexArray.unbind(),this.vertexBuffer.unbind(),d.unbind();const f=new Array(c.maxTextureSlots);for(let t=0;t<c.maxTextureSlots;t++)f[t]=t;this.shaderProgram.bind(),this.shaderProgram.setValueArrayI("u_Textures",f),this.shaderProgram.unbind(),this.textureSlots[0]=this.whiteTexture}begin(t){this.viewProjectionMatrix=t.getViewProjectionMatrix(),this.quadIndexCount=0,this.quadVertexBufferIndex=0,this.textureSlotIndex=1}drawTrianglesWithColor(t,e,r,s){this.drawTriangles(t,e,r,s,this.whiteTexture)}drawTrianglesWithTexture(t,e,r,s){this.drawTriangles(t,e,r,this.whiteColor,s)}drawTriangles(t,e,r,s,i){this.quadIndexCount>=c.maxIndices&&this.newBatch();let a=-1;for(let t=0;this.textureSlotIndex&&this.textureSlots[t];t++)if(this.textureSlots[t].equal(i)){a=t;break}-1===a&&(a=this.textureSlotIndex,this.textureSlots[this.textureSlotIndex]=i,this.textureSlotIndex++);const n=l.default.getWorldMatrix(t,e,r),o=l.default.getVectorFromWorldMatrix(n,this.quadPositions[0]),h=l.default.getVectorFromWorldMatrix(n,this.quadPositions[1]),u=l.default.getVectorFromWorldMatrix(n,this.quadPositions[2]),d=l.default.getVectorFromWorldMatrix(n,this.quadPositions[3]);this.fillQuadVertexBuffer(o,s,0,0,a),this.fillQuadVertexBuffer(h,s,1,0,a),this.fillQuadVertexBuffer(u,s,1,1,a),this.fillQuadVertexBuffer(d,s,0,1,a),this.quadIndexCount+=6,this.statistics.increaseQuadsCount()}end(){this.vertexBuffer.setFloat32Data(this.quadVertexBuffer.slice(0,this.quadVertexBufferIndex)),this.shaderProgram.bind(),this.vertexArray.bind();for(let t=0;t<c.maxTextureSlots;t++){const e=this.textureSlots[t];if(!e)break;e.bind(t)}this.shaderProgram.setMatrix4f("u_ViewProjectionMatrix",this.viewProjectionMatrix),this.drawTrianglesImpl(this.vertexArray,this.quadIndexCount),this.statistics.increaseDrawMethodCallsCount(),this.shaderProgram.unbind(),this.vertexArray.unbind()}newBatch(){this.end(),this.quadIndexCount=0,this.quadVertexBufferIndex=0,this.textureSlotIndex=1}fillQuadVertexBuffer(t,e,r,s,i){this.quadVertexBuffer[this.quadVertexBufferIndex]=t.getX(),this.quadVertexBuffer[this.quadVertexBufferIndex+1]=t.getY(),this.quadVertexBuffer[this.quadVertexBufferIndex+2]=t.getZ(),this.quadVertexBuffer[this.quadVertexBufferIndex+3]=e.getX(),this.quadVertexBuffer[this.quadVertexBufferIndex+4]=e.getY(),this.quadVertexBuffer[this.quadVertexBufferIndex+5]=e.getZ(),this.quadVertexBuffer[this.quadVertexBufferIndex+6]=e.getW(),this.quadVertexBuffer[this.quadVertexBufferIndex+7]=r,this.quadVertexBuffer[this.quadVertexBufferIndex+8]=s,this.quadVertexBuffer[this.quadVertexBufferIndex+9]=i,this.quadVertexBufferIndex+=10}getStatics(){return this.statistics}resetStatistics(){this.statistics.reset()}clean(){var t,e,r;null===(t=this.vertexBuffer)||void 0===t||t.clean(),null===(e=this.vertexArray)||void 0===e||e.clean();for(const t of this.textureSlots){if(!t)break;t.clean()}null===(r=this.shaderProgram)||void 0===r||r.clean()}}c.maxQuads=1e4,c.maxVertices=4*c.maxQuads,c.maxIndices=6*c.maxQuads,c.maxTextureSlots=16,e.default=c},3665:(t,e)=>{var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.WEB_GL=0]="WEB_GL"}(r||(r={})),e.default=r},1649:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.drawMethodCallsCount=0,this.quadsCount=0}increaseDrawMethodCallsCount(){this.drawMethodCallsCount++}increaseQuadsCount(){this.quadsCount++}reset(){this.drawMethodCallsCount=0,this.quadsCount=0}getDrawMethodCallsCount(){return this.drawMethodCallsCount}}},9380:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getComponentCountFromShaderDataType=void 0;const s=r(1073);var i;!function(t){t[t.FLOAT_1=s.default.FLOAT.valueOf()]="FLOAT_1",t[t.FLOAT_2=2*s.default.FLOAT.valueOf()]="FLOAT_2",t[t.FLOAT_3=3*s.default.FLOAT.valueOf()]="FLOAT_3",t[t.FLOAT_4=4*s.default.FLOAT.valueOf()]="FLOAT_4",t[t.INT_1=s.default.INT.valueOf()]="INT_1",t[t.INT_2=2*s.default.INT.valueOf()]="INT_2",t[t.INT_3=3*s.default.INT.valueOf()]="INT_3",t[t.INT_4=4*s.default.INT.valueOf()]="INT_4"}(i||(i={})),e.getComponentCountFromShaderDataType=function(t){switch(t){case i.FLOAT_1:return 1;case i.FLOAT_2:return 2;case i.FLOAT_3:return 3;case i.FLOAT_4:return 4;case i.INT_1:return 1;case i.INT_2:return 2;case i.INT_3:return 3;case i.INT_4:return 4}throw new Error("ShaderDataType [ "+t+" ] not supported")},e.default=i},1893:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.shaderPrograms=new Map}add(t){this.shaderPrograms.set(t.getName(),t)}get(t){const e=this.shaderPrograms.get(t);if(!e)throw new Error("Shader program by name [ "+t+" ] not found in library");return e}clean(){this.shaderPrograms.clear()}}},1073:(t,e)=>{var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.FLOAT=4]="FLOAT",t[t.INT=4]="INT",t[t.UNSIGNED_INT=4]="UNSIGNED_INT"}(r||(r={})),e.default=r},3466:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.uuid=void 0,e.uuid=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(t=>{const e=Number(t);return((15&(e^crypto.getRandomValues(new Uint8Array(1))[0]))>>e/4).toString(16)}))},8191:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t=0){this.timestamp=t,this.deltaTime=0}update(t){this.deltaTime=t-this.timestamp,this.timestamp=t}getTimestamp(){return this.timestamp}getDeltaTime(){return this.deltaTime}}}},e={};function r(s){var i=e[s];if(void 0!==i)return i.exports;var a=e[s]={exports:{}};return t[s](a,a.exports,r),a.exports}r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");if(s.length)for(var i=s.length-1;i>-1&&!t;)t=s[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{const t=r(1969),e=r(3325),s=document.getElementById("game");if(!s)throw new Error("Game element nof found");new t.default(s,new e.default).start()})()})();